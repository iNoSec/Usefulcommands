<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Obtain</title>
</head><body>Options<br/>
1 Boot the target system to an alternate OS and copy the files to removable media<br/>
Windows password hashes are stored in the SAM file located within %windir%\system32\config <br/>
<br/>
If the Create Emergency Repair Disk function was used, there will also be a backup of the Registry including the SAM hive located in the directory %windir%\repair\RegBack <br/>
<br/>
Domain Controller: the hashes are stored in the ntds.dit file located within %windir%\WindowsDS<br/>
<br/>
2 Sniff the LM hash off the network<br/>
If one of these networks is encountered, the LM hash will be used in conjunction with the LM protocol which transmits the hash in cleartext across the network <br/>
<br/>
3 Dump the hash locally<br/>
There are currently several tools available that provide this capability: pwdump, fgdump, and gsecdump [CIAC 2008]. These tools effectively seek out and obtain hashes via the registry and through DLL injection <br/>
<br/>
4 Dump the hash remotely<br/>
The same tools used locally (pwdump, fgdump, gsecdump) also work remotely with the exception of the latter which must be used in conjunction with the psexec tool <br/>
<br/>
5 Dump and analyze contents of memory<br/>
This method can be performed locally or remotely depending on what tools are used. The ManTech Memory DD (MDD) is a tool that can copy everything in memory for multiple Windows operating systems. One such tool that can perform this analysis and extract the hashes is Volatility from Volatile System.<br/>
<br/>
6 Implement a rogue SMB server to collect hashes<br/>
There are multiple ways this can happen, but technically speaking the end result is the same: the victim opens an SMB connection and happily transmits their username and password hash to the rogue system. The original SMB relay tool (called SMBRelay) was created by Sir Dystic (Cult of the Dead Cow) in March of 2001 [Grutzmacher 2008]. Another option is to use the auxiliary module called smb_sniffer within Metasploit that also provides this capability.</body></html>